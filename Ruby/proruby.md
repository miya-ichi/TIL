# プロを目指す人のためのRuby入門
## 第1章
irbの入力に日本語が使えるようにしたい。まだできていない。  
rbenvをインストールしたのちRubyの2.4.10を試しに入れようとしたがビルドエラーが出てインストール失敗。環境がM1Macだからだろうか？詳細未確認
## 第2章
### 改行について
改行で文の区切りになるが、セミコロンで明示的に区切ることもできる。一行に複数の処理を書く場合に使ったりする。  
(で改行する場合は)を書くまで改行してもエラーにならない。  
明示的に改行を表す場合は/を使う。
### コメントについて
複数行のコメントでも#を使うことが多い。  
テキストエディタの機能で一気にコメントアウトすることができる。VSCodeは範囲選択→`command+/`
### 変数について
変数は宣言と同時に何かしら代入する必要がある。  
小文字のスネークケースでかく  
複数同時に代入することも可能（多重代入）だが理解しづらくなるため特別な理由がなければ避ける `a, b = 1, 2`
### 数値について
数値には_を含めることができる。_は無視されるため、桁の区切りに使うことができる。  
例 1_000_000  
小数を扱う際は丸め誤差に注意。Rational(有理数)クラスを活用。  
### 真偽値・条件分岐
false・nil以外は真これ大事！  
論理演算子の優先順位（上にあるものが高い）
```
!
&&
||
not
and/or
```
優先順位は他の演算子の様に()で囲うことで変えられる  
if文は`if 条件式 then 処理`とthenを使って一行で書くこともできる
条件式は全体が真か偽に確定するまで左から順に評価していく  

case文のwhenの後には、複数の条件を書くことも可能（どれかに当てはまっていれば処理が実行される）

条件演算子（三項演算子）  
`式 ? 真だった場合の処理 : 偽だった場合の処理`  
簡単なif文だったら置き換えることで可読性が上がる。  

### 文字列
%記法  
%qで始めるとシングルクオートで囲ったのと同じ扱い  
%Qで始めるとダブルクオートで囲ったのと同じ扱い  
ヒアドキュメント（行指向文字列リテラル）  
```
<<識別子
ヒアドキュメントを使うことで
複数行にわたる文字列を
見やすく書くことができる
識別子はテキスト内に出てこないものにする
識別子
```
ヒアドキュメントは式の一つである。  
ヒアドキュメントをメソッドの引数にすることもできる（書き方が変な感じ）
### ガベージコレクション
使用されなくなったオブジェクトを回収し、自動でメモリを開放する仕組み
### エイリアスメソッド
機能が全く同じで、名前が異なるメソッドのこと。
### 参照
変数はオブジェクトへの参照を格納している  
変数を別の変数に代入すると、別の変数が同じオブジェクトへの参照を持つ  
なので、オブジェクトに変更を加えた場合はそれぞれの変数が影響を受ける
## 第3章
### テスティングフレームワーク
コードのテストを自動化する仕組み。Rubyのライブラリとして導入
- Minitest  
- RSpec
- test-unit
### Minitest
テストクラスはTestから始まるか、Testで終わる名前にすることが多い  
テストコードを書いたファイルはクラス名と同じ名前にする  
Minitestはtest_で始まるメソッドを探してすべて実行する  
### requireとrequire_relativeの違い
ライブラリ及び分離したrbファイルを読み込む際に用いるが、フォルダの解釈に違いがある。
- require  
requireの場合は指定するパスが「現在Rubyを実行しているフォルダ」を起点とする
- require_relative
require_relativeは「実行したコードのあるフォルダ」が起点となる
## 第4章
### ブロック
非常によく使われる。メソッドに引数として渡される処理の塊。  
`do 〜 end`で囲まれた処理の塊。  
ブロック内で定義した変数はブロック内でのみ有効。  
ブロック外とブロック内で同じ名前の変数を定義した場合は、ブロック内のものが優先される。  
{}でもブロックを記述できる。  
長いブロックを書く場合はdo end、1行のブロックは{}を使うことが多い
### 配列を使った多重代入
`a, b = [1, 2]`でaに1、bに2が代入される
### ブロックを使う配列のメソッド
- map:ブロック内の処理結果を代入した新しい配列を作る
- select:ブロック内の条件を満たした値を代入した新しい配列を作る
- reject:ブロック内の条件を満たさない値を代入した新しい配列を作る
- inject:たたみ込み演算を行う。なんかすごい  

map(&:upcase)のような省略した書き方がある。書ける条件が決まっている。
### 範囲オブジェクト
最初の値..最後の値（最後の値を含む）  
最初の値...最後の値（最後の値を含まない）  
配列から一定範囲を抜き出す時に便利 `a[2..4] => [3, 4, 5]`
### テスト駆動開発

### ミュータブルなオブジェクトとイミュータブルなオブジェクト
ミュータブルなオブジェクトは破壊的変更を行うメソッドの対象にすることができるが、イミュータブルなオブジェクトはそれができない
- ミュータブルなオブジェクト例
    - 文字列
- イミュータブルなオブジェクト例
    - 数値
    - シンボル
    - true/false
    - nil

## 第5章
### ハッシュ
キーと値の組み合わせでデータを管理するオブジェクト  
キーと値が大量に格納されていても、指定したキーから高速に値を取り出すことができる  
==でハッシュを比較すると、キーと値が完全に一致している場合のみtrueとなる  
キーと値は異なるデータ型を混在させることができる(が、キーは同じデータ型にそろえる)  

使用頻度の高いメソッド
- keys:ハッシュのキーを配列として返す
- values:ハッシュの値を配列として返す
- has_key?/key?/include?/member?:ハッシュの中に指定したキーが存在するか確認する

ハッシュ名の前に**をつけるとハッシュの中にハッシュの展開ができる
```ruby
a = { x: "XXX", y: "YYY" }
{ z: "ZZZ", **a }
=>  { z: "ZZZ", x: "XXX", y: "YYY" }
```

### キーワード引数
キーワード引数はシンボルの形で指定する  
```
def メソッド名(キーワード引数1: デフォルト値1, キーワード引数2: デフォルト値2)
    処理
end
```
デフォルト値は省略可能  
キーワード引数を使うメソッドには引数に一致するハッシュを渡すことも可能  
### シンボル
`:シンボル名`で表されるオブジェクト(Symbolクラスのオブジェクト)  
文字列の代わりにしようすることもできる  
Rubyの内部的には整数で管理されるため、文字列と比べて、同じ値の比較が高速に処理できる  
同じシンボルは同じオブジェクトとなるため、大量の文字列と大量のシンボルを作成した場合、シンボルの方がメモリの使用効率が良い  
イミュータブルである  
ハッシュのキーに向いている  
### 擬似キーワード引数
Ruby2.0より前はキーワード引数がサポートされていないため、ハッシュを引数として受け取るようにしてキーワード引数のような使い方をしていた。  
昔からあるプログラムでは使用されているかも

## 第7章
### クラスを使うプログラミングと、使わないプログラミングの違い
大きなプログラムになると、データの保持をハッシュなどで行う場合にデータが途中で追加されたり変更されたりと脆いプログラムになりがちである。 
また、クラスはデータとメソッドをセットで持つことで、プログラムが整理しやすくなる  

### クラス
一種のデータ型。オブジェクトの設計図などと呼ばれる
### オブジェクト、インスタンス、レシーバ
クラスをもとにして作られたデータのかたまり。インスタンスもほぼ同じ意味。  
メソッドを呼び出されるオブジェクトのことをレシーバと呼ぶ
### メソッド、メッセージ
何らかの処理をひとまとめにして名前をつけたもの  
オブジェクトに対して呼び出すメソッドをメッセージと呼ぶことがある。(Smalltalkの影響)
### 状態（ステート）
オブジェクトごとに保持されるデータのこと
### 属性（アトリビュート、プロパティ）
オブジェクトから取得または設定できる値のこと
### インスタンス変数
`@変数名`で定義する、インスタンス内で共有される変数。  
クラスの外部からは読み書き用のメソッド(アクセサメソッド)を用意しないと読み書きできない。  
- attr_accessor:読み書きのメソッドを自動定義してくれる
- attr_reader:読み取り専用のメソッドを自動定義
- attr_writer:書き込み専用のメソッドを自動定義
### インスタンスメソッド
クラスの内部で定義したメソッド。  
そのクラスのインスタンスに対して呼び出すことができる。  
インスタンスに含まれるデータ（インスタンス変数）を扱う場合に定義して使用する
### クラスメソッド
クラスに関連が深いが、データは扱わない場合に定義すると使い勝手が良い。  
特異メソッドの一種  
クラスメソッドの定義の方法は２通りある。
- メソッド名の前にself.をつける
- class << self から end の間にメソッドを書く
